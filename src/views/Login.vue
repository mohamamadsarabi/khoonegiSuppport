<template>
  <main class="mt-0 main-content-login">

    <div class="background-cover h-100">
        <div class="brand-cover">
          <svg xmlns="http://www.w3.org/2000/svg" width="288" height="80" viewBox="0 0 288 80" fill="none">
            <path
                d="M227.772 33.9963C228.27 33.9963 228.672 33.5934 228.672 33.0963C228.672 32.8678 228.687 32.6346 228.703 32.3685L228.704 32.357C228.72 32.1033 228.738 31.8182 228.738 31.5285C228.738 22.1938 222.234 13.4471 211.702 13.4471C201.187 13.4471 193.882 21.3205 193.882 31.3978C193.882 41.7617 201.408 49.3485 211.963 49.3485C217.996 49.3485 222.956 46.8911 225.985 42.977C226.916 41.774 226.428 40.1527 225.243 39.4526C223.984 38.7086 222.485 39.212 221.692 40.2176C219.747 42.6842 216.385 44.4127 212.028 44.4127C205.362 44.4127 200.321 40.3347 199.213 33.9963H227.772ZM23.1732 48.6299C25.3659 48.6299 26.4237 45.9432 24.8196 44.4484L10.1298 30.759L23.989 18.3939C25.6488 16.9131 24.6013 14.1657 22.377 14.1657C21.7801 14.1657 21.2042 14.3862 20.7599 14.7848L6.16642 27.8786V3.63321C6.16642 2.23415 5.03226 1.1 3.63321 1.1C2.23416 1.1 1.1 2.23416 1.1 3.63321V46.0967C1.1 47.4957 2.23416 48.6299 3.63321 48.6299C5.03226 48.6299 6.16642 47.4957 6.16642 46.0967V33.7226L21.5303 47.9849C21.9769 48.3995 22.5638 48.6299 23.1732 48.6299ZM238.046 55.5195L238.796 55.021L238.046 55.5195C240.914 59.8314 246.332 62.4142 253.438 62.4142C258.126 62.4142 262.417 60.9699 265.55 58.1855C268.695 55.3895 270.605 51.2999 270.605 46.162V16.6989C270.605 15.2998 269.47 14.1657 268.071 14.1657C266.672 14.1657 265.538 15.2998 265.538 16.6989V19.6283C262.509 15.8069 257.909 13.4471 252.393 13.4471C242.556 13.4471 234.573 21.2299 234.573 31.3978C234.573 41.5657 242.556 49.3485 252.393 49.3485C257.909 49.3485 262.509 46.9887 265.538 43.1672V46.162C265.538 49.6858 264.4 52.4875 262.38 54.4113C260.355 56.3395 257.347 57.4784 253.438 57.4784C247.546 57.4784 244.29 55.4874 242.522 53.0199C241.757 51.9513 240.232 51.3832 238.927 52.1243C237.784 52.7737 237.231 54.294 238.046 55.5195ZM50.4997 13.4471C46.1848 13.4471 42.3997 14.9199 39.7059 18.2344V3.63321C39.7059 2.23415 38.5718 1.1 37.1727 1.1C35.7737 1.1 34.6395 2.23416 34.6395 3.63321V46.0967C34.6395 47.4957 35.7737 48.6299 37.1727 48.6299C38.5718 48.6299 39.7059 47.4957 39.7059 46.0967V30.4832C39.7059 26.2439 40.912 23.2388 42.7712 21.2984C44.6291 19.3594 47.2353 18.3828 50.2384 18.3828C53.1113 18.3828 55.2567 19.2941 56.6882 20.8116C58.1268 22.3365 58.9417 24.5769 58.9417 27.4128V46.064C58.9417 47.4811 60.0905 48.6299 61.5076 48.6299C62.9246 48.6299 64.0734 47.4811 64.0734 46.064V27.4128C64.0734 23.2738 62.7878 19.7677 60.3998 17.291C58.0082 14.8105 54.5921 13.4471 50.4997 13.4471ZM173.128 13.4471C168.813 13.4471 165.028 14.9199 162.335 18.2344V16.6989C162.335 15.2998 161.2 14.1657 159.801 14.1657C158.402 14.1657 157.268 15.2998 157.268 16.6989V46.0967C157.268 47.4957 158.402 48.6299 159.801 48.6299C161.2 48.6299 162.335 47.4957 162.335 46.0967V30.4832C162.335 26.2439 163.541 23.2388 165.4 21.2984C167.258 19.3594 169.864 18.3828 172.867 18.3828C175.74 18.3828 177.885 19.2941 179.317 20.8116C180.755 22.3365 181.57 24.5769 181.57 27.4128V46.064C181.57 47.4811 182.719 48.6299 184.136 48.6299C185.553 48.6299 186.702 47.4811 186.702 46.064V27.4128C186.702 23.2738 185.416 19.7677 183.028 17.291C180.637 14.8105 177.221 13.4471 173.128 13.4471ZM211.702 18.3828C217.371 18.3828 222.401 22.1113 223.427 28.9952H199.196C200.185 22.72 205.072 18.3828 211.702 18.3828ZM252.589 44.4127C245.317 44.4127 239.639 38.6804 239.639 31.3978C239.639 24.1152 245.317 18.3828 252.589 18.3828C259.86 18.3828 265.538 24.1152 265.538 31.3978C265.538 38.6804 259.86 44.4127 252.589 44.4127ZM283.387 8.06094C285.321 8.06094 286.9 6.4821 286.9 4.54781C286.9 2.66415 285.306 1.1 283.387 1.1C281.467 1.1 279.874 2.66417 279.874 4.54781C279.874 6.48209 281.453 8.06094 283.387 8.06094ZM280.854 46.0967C280.854 47.4957 281.988 48.6299 283.387 48.6299C284.786 48.6299 285.92 47.4957 285.92 46.0967V16.6989C285.92 15.2998 284.786 14.1657 283.387 14.1657C281.988 14.1657 280.854 15.2998 280.854 16.6989V46.0967Z"
                fill="#664ECA" stroke="#664ECA" stroke-width="1.8" stroke-linejoin="round"/>
            <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M89.6473 12.585C78.9973 12.585 70.6406 20.8683 70.6406 31.4567C70.6406 42.0452 78.9902 50.3261 89.6473 50.3261C100.266 50.3261 108.581 42.0428 108.581 31.4567C108.581 20.8706 100.266 12.585 89.6473 12.585ZM89.4863 18.1939C90.0279 18.194 90.5691 18.2232 91.1075 18.2815C97.5614 18.9655 102.467 24.2408 102.749 30.8248C102.924 34.7819 101.521 38.4194 98.7968 41.0654C96.1106 43.6687 92.4991 44.9561 88.6201 44.6721C85.4806 44.4511 82.5261 43.1049 80.2993 40.8807C78.0725 38.6565 76.7228 35.7036 76.4981 32.5643C76.1762 28.354 77.5394 24.5319 80.3439 21.8007C82.7627 19.4459 85.9648 18.1939 89.4863 18.1939ZM131.052 12.585C120.402 12.585 112.045 20.8683 112.045 31.4567C112.045 42.0452 120.395 50.3261 131.052 50.3261C141.671 50.3261 149.985 42.0428 149.985 31.4567C149.985 20.8706 141.671 12.585 131.052 12.585ZM130.891 18.1939C131.433 18.1939 131.974 18.2232 132.512 18.2815C138.966 18.9655 143.872 24.2408 144.154 30.8248C144.329 34.7819 142.926 38.4194 140.202 41.0654C137.515 43.6687 133.906 44.9561 130.025 44.6721C126.885 44.4511 123.931 43.1049 121.704 40.8807C119.477 38.6565 118.128 35.7036 117.903 32.5643C117.572 28.3564 118.935 24.5342 121.739 21.8031C124.167 19.4459 127.37 18.1939 130.891 18.1939ZM104.91 79.4337C106.705 79.6331 108.509 79.7327 110.315 79.7319C116.186 79.7528 122.009 78.6781 127.485 76.5629C127.717 76.4824 127.945 76.3901 128.167 76.2907C129.643 75.6854 131.084 74.998 132.484 74.2317C137.695 71.3799 140.651 68.353 141.276 67.5175C141.444 67.2938 141.566 67.0391 141.635 66.7682C141.705 66.4972 141.72 66.2152 141.681 65.9383C141.641 65.6614 141.547 65.395 141.405 65.1543C141.262 64.9136 141.074 64.7034 140.85 64.5355C140.626 64.3677 140.372 64.2456 140.101 64.1762C139.83 64.1068 139.548 64.0914 139.271 64.131C138.994 64.1705 138.727 64.2642 138.487 64.4067C138.246 64.5492 138.036 64.7378 137.868 64.9615C137.586 65.326 136.192 66.7531 133.767 68.4405C133.807 67.9722 133.814 67.5016 133.785 67.0324C133.658 64.5166 132.536 62.1547 130.667 60.4661C128.797 58.7775 126.334 57.9007 123.818 58.0284C121.303 58.1561 118.941 59.278 117.252 61.1472C115.563 63.0164 114.687 65.4799 114.814 67.9956C114.81 68.0823 114.81 68.1692 114.814 68.2559C114.952 69.3739 114.768 70.508 114.282 71.5243C112.978 74.0945 109.324 75.5547 105.253 75.1879C100.013 74.6124 94.933 73.0352 90.2886 70.5421C85.7423 68.0713 83.165 65.4727 82.7721 64.9663C82.6071 64.7357 82.3977 64.5405 82.1563 64.3919C81.9149 64.2434 81.6462 64.1445 81.366 64.1011C81.0859 64.0577 80.7999 64.0707 80.5248 64.1393C80.2498 64.2078 79.9912 64.3306 79.7642 64.5005C79.5372 64.6703 79.3463 64.8837 79.2029 65.1282C79.0594 65.3727 78.9662 65.6434 78.9288 65.9244C78.8913 66.2054 78.9103 66.4911 78.9846 66.7646C79.059 67.0382 79.1872 67.2942 79.3617 67.5175C79.9865 68.353 82.9472 71.3776 88.1539 74.2317C93.0393 76.8766 98.3706 78.5976 103.88 79.3082L104.034 79.3343C104.328 79.3745 104.619 79.4076 104.91 79.4337ZM118.08 73.4508C118.904 71.771 119.247 69.8961 119.072 68.0335C119.072 68.0074 119.07 67.9601 119.067 67.9317C119.011 66.5612 119.495 65.2236 120.415 64.2059C121.334 63.1883 122.616 62.5717 123.985 62.4887C125.355 62.4057 126.702 62.8628 127.737 63.7618C128.773 64.6609 129.415 65.9303 129.525 67.2974C129.585 68.3421 129.332 69.3809 128.798 70.281C128.265 71.181 127.475 71.9015 126.529 72.3503C123.51 73.5831 120.357 74.4568 117.134 74.9536C117.497 74.4847 117.814 73.9813 118.08 73.4508Z"
                  fill="#332E54"/>
          </svg>
          <h6>پنل مدیریت</h6>
        </div>
    </div>
    <div class="h-100 box-body">
      <div class="card-body">
        <h6>ورود به پنل</h6>
        <form @submit.prevent class="text-right">
          <khoonegiInput
              placeholder="نام کاربری"
              class="from-input mb-3"
              :align-left="true"
              @globalInputValue="setUserName($event)"
          />
          <khoonegiInput
              class="from-input"
              placeholder="رمز عبور"
              :align-left="false"
              input-type="password"
              @globalInputValue="setPassword($event)"
          />
          <khoonegiButton
              class="form-button mt-5"
              text="ورود"
              @click.prevent="submitLogin"
          />
        </form>
      </div>
    </div>
  </main>
  <LoadingFull :enable-loading-full="loading"/>
</template>

<script>
import khoonegiInput from "@/components/khoonegiInput.vue";
import khoonegiButton from "@/components/khoonegiButton.vue";
import LoadingFull from "@/components/LoadingCircle.vue";
import {useToast} from "vue-toastification";

const body = document.getElementsByTagName("body")[0];

export default {
  name: "login",
  components: {
    khoonegiInput,
    khoonegiButton,
    LoadingFull,
  },
  data() {
    return {
      username: "",
      password: "",
      toast: useToast(),
      loading: false,
    };
  },
  methods: {
    setUserName(val) {
      this.username = val;
    },
    setPassword(val) {
      this.password = val;
    },
    submitLogin() {
      if (this.username.length > 0 && this.password.length > 0) {
        this.loading = true;
        const item = {
          username: this.username,
          password: this.password,
        };
        this.$store
            .dispatch("login", item)
            .then((respons) => {
              console.log(respons)
              if (respons.data.succeed) {
                this.loading = false;
                this.toast.success(respons.data.message, {
                  position: "bottom-center",
                  timeout: 3000,
                  icon: true,
                  rtl: true,
                });
                this.$router.push("/InfoChef");
              } else {
                this.loading = false;
                this.toast.error(respons.data.message, {
                  position: "bottom-center",
                  timeout: 3000,
                  icon: true,
                  rtl: true,
                });
              }
            })
            .catch((error) => {
              console.log(error);
              this.$store.dispatch("handleError", error);
              this.loading = false;
              this.toast.error("خطا در اتصال!", {
                position: "bottom-center",
                timeout: 3000,
                icon: true,
                rtl: true,
              });
            });
      } else {
        this.toast.error("لطفا نام کاربری و رمز عبور را وارد نمایید", {
          position: "bottom-center",
          timeout: 3000,
          icon: true,
          rtl: true,
        });
      }
    },
  },
  beforeMount() {
    this.$store.state.hideConfigButton = true;
    this.$store.state.showNavbar = false;
    this.$store.state.showSidenav = false;
    this.$store.state.showFooter = false;
    body.classList.remove("bg-gray-100");
  },
  beforeUnmount() {
    this.$store.state.hideConfigButton = false;
    this.$store.state.showNavbar = true;
    this.$store.state.showSidenav = true;
    this.$store.state.showFooter = true;
    body.classList.add("bg-gray-100");
  },
  watch: {},
};
</script>
<style lang="scss">
.card-header {
  h5 {
    color: #d144b1;
  }
}

.main-content-login {
  background-color: #F8F9FA;
  position: fixed;
  width: 100%;
  top: 0;
  bottom: 0;
  display: grid;
  align-items: center;
  grid-template-columns: 1fr 1fr;
  @media (max-width: 768px){
    grid-template-columns: 1fr;
  }
  > div {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .background-cover {
    background-color: #F2F2F2;
  }
.box-body {
  @media (max-width: 768px) {
      height: 150px !important;
  }
}
  .brand-cover {
    h6 {
      text-align: center;
      margin-top: 3rem;
      color: #332E54;
      padding: 10px;
      border-radius: 50px;
      background-color: #fff;
    }
  }
  .card-body {
    padding: 1rem 10rem;
    @media (max-width: 768px){
      padding: 1rem 2rem;
    }
    input {
      padding: 0.8rem 1rem !important;
      background-color: #F8F9FA !important;
    }
    h6 {
      font-weight: 500;
      font-size: 32px;
      line-height: 46px;
      color: #664ECA;
      margin-bottom: 6rem;
      @media (max-width: 768px){
        text-align: center;
      }
    }
    button {
      width: fit-content;
      float: left;
      background-color: #F8F9FA;
      border: 2px solid #664eca;
      color: #664eca;
      border-radius: 50px !important;
      &:hover {
        color: #fff;
        background-color: #664eca;
      }
    }
  }
}

.submit-account {
  background-color: #664eca !important;
}

.form-button {
  width: 100%;
  margin-top: 20px;
}

.card-plain {
  @media (max-width: 768px) {
    padding: 0;
  }
}
</style>
